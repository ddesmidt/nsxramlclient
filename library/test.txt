

import argparse
import ConfigParser
import json
from libutils import get_scope
from libutils import get_logical_switch
from tabulate import tabulate
from nsxramlclient.client import NsxClient
from pyVim.connect import SmartConnect, Disconnect
import ssl
from pyVmomi import vim, vmodl

config = ConfigParser.ConfigParser()
config.read("nsx.ini")
client_session = NsxClient(config.get('nsxraml', 'nsxraml_file'), config.get('nsxv', 'nsx_manager'),
                               config.get('nsxv', 'nsx_username'), config.get('nsxv', 'nsx_password'), debug="True")


context = ssl.SSLContext(ssl.PROTOCOL_TLSv1)
context.verify_mode = ssl.CERT_NONE
si = SmartConnect(host="10.114.218.201",
                     user="administrator@vsphere.local",
                     pwd="VMware1!",
                     port=int("443"),
                     sslContext=context)


#DatacenterMoid
content = si.RetrieveContent()
datacenter_list = content.rootFolder.childEntity
for datacenter in datacenter_list:
    if datacenter.name == "Lab1":
        datacentermoid = datacenter._moId
print datacentermoid

#datastore
content = si.RetrieveContent()
datacenter_list = content.rootFolder.childEntity
for datacenter in datacenter_list:
    if datacenter.name == "Lab1":
        for datastore in datacenter.datastore:
            if datastore.name == "NFS_Lab1":
                datastorename = datastore._moId
print datastorename

#resourcepoolid
content = si.RetrieveContent()
datacenter_list = content.rootFolder.childEntity
for datacenter in datacenter_list:
    if datacenter.name == "Lab1":
        cluster_list = datacenter.hostFolder.childEntity
        for cluster in cluster_list:
            if cluster.name == "Cluster-MgtEdge":
                resourcepoolid = cluster.resourcePool._moId
print resourcepoolid


### Do I need to do the disconnect of the vCenter?